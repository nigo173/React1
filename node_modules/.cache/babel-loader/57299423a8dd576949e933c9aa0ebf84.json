{"ast":null,"code":"import _defineProperty from\"D:\\\\React\\\\home_work\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";import _classCallCheck from\"D:\\\\React\\\\home_work\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"D:\\\\React\\\\home_work\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"D:\\\\React\\\\home_work\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"D:\\\\React\\\\home_work\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React,{Fragment,Component}from'react';import Controller from'./Controller';var Lesson4=/*#__PURE__*/function(_Component){_inherits(Lesson4,_Component);var _super=_createSuper(Lesson4);function Lesson4(props){var _this$state;var _this;_classCallCheck(this,Lesson4);_this=_super.call(this,props);_this.play=function(e){var currentImgX=_this.state.currentImgX;var currentImgY=_this.state.currentImgY;var move=e.target.textContent;var moveX=0;var moveY=0;_this.setState({defArray:[currentImgX,currentImgY,moveX,moveY]});switch(move){case'上':moveX=currentImgX;if(currentImgY>=1)moveY=currentImgY-34;break;case'下':moveX=currentImgX;if(currentImgY>=0&&currentImgY<100)moveY=currentImgY+34;else moveY=currentImgY;break;case'左':if(currentImgX>1)moveX=currentImgX-32;else moveX=currentImgX;moveY=currentImgY;break;case'右':if(currentImgX>=0&&currentImgX<238)moveX=currentImgX+32;else moveX=currentImgX;moveY=currentImgY;break;default:break;}_this.setState({currentImgX:moveX,currentImgY:moveY});};_this.canvas=React.createRef();_this.state=(_this$state={imgMain:new Image(),imgMountain:new Image(),imgEnemy:new Image(),currentImgX:0,currentImgY:0},_defineProperty(_this$state,\"imgMain\",new Image()),_defineProperty(_this$state,\"mapArray\",[0,1,1,0,0,0,3,1,2]),_defineProperty(_this$state,\"defArray\",[0,0,0,0]),_this$state);return _this;}_createClass(Lesson4,[{key:\"componentDidMount\",value:function componentDidMount(){this.updateCanvas();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(e){console.log(e.code);this.updateCanvas();}},{key:\"componentWillReceiveProps\",value:function componentWillReceiveProps(_ref){var keydown=_ref.keydown;if(keydown.event){// inspect the keydown event and decide what to do\nconsole.log(keydown.event.which);}}},{key:\"updateCanvas\",value:function updateCanvas(){var ctx=this.canvas.current.getContext('2d');var imgMain=this.state.imgMain;var imgMountain=this.state.imgMountain;var imgEnemy=this.state.imgEnemy;var currentImgX=this.state.currentImgX;var currentImgY=this.state.currentImgY;imgMain.src='../assets/img/canvas/spriteSheet.png';imgMountain.src='../assets/img/canvas/material.png';imgEnemy.src='../assets/img/canvas/Enemy.png';var r_currentImgX=this.state.defArray[0];var r_currentImgY=this.state.defArray[1];ctx.clearRect(r_currentImgX,r_currentImgY,50,50);imgMain.onload=function(){ctx.drawImage(imgMain,0,0,80,130,currentImgX,currentImgY,50,50);};var arr=this.state.mapArray;imgMountain.onload=function(){imgEnemy.onload=function(){for(var x in arr){if(arr[x]==1){ctx.drawImage(imgMountain,32,65,32,32,x%3*150,Math.floor(x/3)*200,50,50);ctx.drawImage(imgMountain,32,65,32,32,x%3*200,Math.floor(x/3)*200,50,50);ctx.drawImage(imgMountain,32,65,32,32,x%3*250,Math.floor(x/3)*200,50,50);ctx.drawImage(imgMountain,32,65,32,32,x%3*150,105,50,50);// ctx.drawImage(imgMountain,32,65,32,32,x%3*200,Math.floor(x/3)*200,50,50);\n}else if(arr[x]==3){ctx.drawImage(imgEnemy,7,40,104,135,x%3*200,100,50,50);}}};};}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"section\",{id:\"lesson4\"},/*#__PURE__*/React.createElement(\"div\",{class:\"container\"},/*#__PURE__*/React.createElement(\"div\",{class:\"row\"},/*#__PURE__*/React.createElement(\"div\",{class:\"col-lg-8 mx-auto\"},/*#__PURE__*/React.createElement(\"div\",{class:\"col-lg-5 text-center\"},/*#__PURE__*/React.createElement(\"h2\",{class:\"textss\"},\"Lesson 4\"),/*#__PURE__*/React.createElement(\"hr\",{class:\"divider-title\"})),/*#__PURE__*/React.createElement(\"p\",{class:\"china-font\"},\"RPG\"),/*#__PURE__*/React.createElement(\"p\",{class:\"china-font\"},\"\\u4E5D\\u5BAE\\u683C\")),/*#__PURE__*/React.createElement(\"div\",{class:\"col-lg-8 mx-auto\"},/*#__PURE__*/React.createElement(\"canvas\",{class:\"canvas\",ref:this.canvas})),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{class:\"col-lg-8 mx-auto\"},/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:this.play},\"\\u4E0A\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:this.play},\"\\u4E0B\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:this.play},\"\\u5DE6\"),/*#__PURE__*/React.createElement(\"button\",{type:\"button\",onClick:this.play},\"\\u53F3\"))))));}}]);return Lesson4;}(Component);export default Lesson4;","map":{"version":3,"sources":["D:/React/home_work/src/Lesson4/index.js"],"names":["React","Fragment","Component","Controller","Lesson4","props","play","e","currentImgX","state","currentImgY","move","target","textContent","moveX","moveY","setState","defArray","canvas","createRef","imgMain","Image","imgMountain","imgEnemy","updateCanvas","console","log","code","keydown","event","which","ctx","current","getContext","src","r_currentImgX","r_currentImgY","clearRect","onload","drawImage","arr","mapArray","x","Math","floor"],"mappings":"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","sourcesContent":["import React, { Fragment, Component } from 'react';\r\nimport Controller from './Controller';\r\n\r\nclass Lesson4 extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n\r\n        this.canvas = React.createRef();\r\n\r\n        this.state = {\r\n            imgMain: new Image(),\r\n            imgMountain: new Image(),\r\n            imgEnemy: new Image(),\r\n            currentImgX: 0,\r\n            currentImgY: 0,\r\n            imgMain: new Image(),\r\n            mapArray: [0, 1, 1, 0, 0, 0, 3, 1, 2],\r\n            defArray: [0, 0, 0, 0]\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.updateCanvas();\r\n    }\r\n\r\n    componentDidUpdate(e) {\r\n        console.log(e.code);\r\n\r\n        this.updateCanvas();\r\n    }\r\n\r\n\r\n    componentWillReceiveProps({ keydown }) {\r\n        if (keydown.event) {\r\n            // inspect the keydown event and decide what to do\r\n            console.log(keydown.event.which);\r\n        }\r\n    }\r\n\r\n    updateCanvas() {\r\n    \r\n        let ctx = this.canvas.current.getContext('2d');\r\n        let imgMain = this.state.imgMain;\r\n        let imgMountain = this.state.imgMountain;\r\n        let imgEnemy = this.state.imgEnemy;\r\n        let currentImgX = this.state.currentImgX;\r\n        let currentImgY = this.state.currentImgY;\r\n        imgMain.src = '../assets/img/canvas/spriteSheet.png';\r\n        imgMountain.src = '../assets/img/canvas/material.png';\r\n        imgEnemy.src = '../assets/img/canvas/Enemy.png';\r\n\r\n        \r\n        let r_currentImgX = this.state.defArray[0];\r\n        let r_currentImgY = this.state.defArray[1];\r\n        ctx.clearRect(r_currentImgX,r_currentImgY,50,50);\r\n\r\n        imgMain.onload = function () {\r\n            ctx.drawImage(imgMain, 0, 0, 80, 130, currentImgX, currentImgY, 50, 50);\r\n        }\r\n\r\n        let arr = this.state.mapArray;\r\n\r\n        imgMountain.onload = function () {\r\n            imgEnemy.onload = function () {\r\n                for (let x in arr) {\r\n                    if (arr[x] == 1) {\r\n                        ctx.drawImage(imgMountain, 32, 65, 32, 32, x % 3 * 150, Math.floor(x / 3) * 200, 50, 50);\r\n                        ctx.drawImage(imgMountain, 32, 65, 32, 32, x % 3 * 200, Math.floor(x / 3) * 200, 50, 50);\r\n                        ctx.drawImage(imgMountain, 32, 65, 32, 32, x % 3 * 250, Math.floor(x / 3) * 200, 50, 50);\r\n\r\n                        ctx.drawImage(imgMountain, 32, 65, 32, 32, x % 3 * 150, 105, 50, 50);\r\n                        // ctx.drawImage(imgMountain,32,65,32,32,x%3*200,Math.floor(x/3)*200,50,50);\r\n                    }\r\n                    else if (arr[x] == 3) {\r\n                        ctx.drawImage(imgEnemy, 7, 40, 104, 135, x % 3 * 200, 100, 50, 50);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n    play = (e) => {\r\n \r\n        let currentImgX = this.state.currentImgX;\r\n        \r\n        let currentImgY = this.state.currentImgY;\r\n\r\n        let move = e.target.textContent;\r\n\r\n        let moveX = 0;\r\n\r\n        let moveY = 0;\r\n\r\n        this.setState({\r\n            defArray:[currentImgX,currentImgY,moveX,moveY]\r\n        });\r\n\r\n        switch (move) {\r\n            case '上':\r\n                moveX = currentImgX;\r\n                if(currentImgY >= 1)\r\n                    moveY = currentImgY - 34;\r\n                break;\r\n            case '下':\r\n                moveX = currentImgX;\r\n                if(currentImgY >= 0 && currentImgY < 100)\r\n                    moveY = currentImgY + 34;\r\n                else\r\n                    moveY = currentImgY;\r\n                break;\r\n            case '左':\r\n                if(currentImgX > 1)\r\n                    moveX = currentImgX - 32;\r\n                else\r\n                    moveX = currentImgX;\r\n\r\n                moveY = currentImgY;\r\n                break;\r\n            case '右':\r\n\r\n                if(currentImgX >= 0 && currentImgX < 238)\r\n                    moveX = currentImgX + 32;\r\n                else\r\n                    moveX = currentImgX;\r\n\r\n                moveY = currentImgY;\r\n                break;\r\n            default:\r\n\r\n                break\r\n        }\r\n\r\n\r\n        this.setState({\r\n            currentImgX: moveX,\r\n            currentImgY: moveY\r\n        });\r\n    }\r\n\r\n\r\n\r\n\r\n    render() {\r\n        return (\r\n            <Fragment>\r\n                <section id=\"lesson4\">\r\n                    <div class=\"container\">\r\n                        <div class=\"row\">\r\n                            <div class=\"col-lg-8 mx-auto\">\r\n                                <div class=\"col-lg-5 text-center\">\r\n                                    <h2 class=\"textss\">Lesson 4</h2>\r\n                                    <hr class=\"divider-title\" />\r\n                                </div>\r\n                                <p class=\"china-font\">RPG</p>\r\n                                <p class=\"china-font\">九宮格</p>\r\n\r\n                            </div>\r\n\r\n                            <div class=\"col-lg-8 mx-auto\">\r\n\r\n                            <canvas class=\"canvas\" ref={this.canvas}></canvas>\r\n                            </div>\r\n                            <br />\r\n\r\n                            <div class=\"col-lg-8 mx-auto\">\r\n                                <button type=\"button\" onClick={this.play}>上</button>\r\n                                <button type=\"button\" onClick={this.play}>下</button>\r\n                                <button type=\"button\" onClick={this.play}>左</button>\r\n                                <button type=\"button\" onClick={this.play}>右</button>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </section>\r\n            </Fragment >\r\n        )\r\n    }\r\n}\r\n\r\nexport default Lesson4;"]},"metadata":{},"sourceType":"module"}